"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdatereactjs"]("main",{

/***/ "./src/shared/Timer/Timer.tsx":
/*!************************************!*\
  !*** ./src/shared/Timer/Timer.tsx ***!
  \************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nexports.Timer = void 0;\r\nvar react_1 = __importStar(__webpack_require__(/*! react */ \"./node_modules/react/index.js\"));\r\nvar timer_css_1 = __importDefault(__webpack_require__(/*! ./timer.css */ \"./src/shared/Timer/timer.css\"));\r\nvar TimerHeader_1 = __webpack_require__(/*! ../TimerHeader/TimerHeader */ \"./src/shared/TimerHeader/TimerHeader.tsx\");\r\nvar TimerClockContainer_1 = __webpack_require__(/*! ../TimerClockContainer/TimerClockContainer */ \"./src/shared/TimerClockContainer/TimerClockContainer.tsx\");\r\nvar TimerButtonsContainer_1 = __webpack_require__(/*! ../TimerButtonsContainer/TimerButtonsContainer */ \"./src/shared/TimerButtonsContainer/TimerButtonsContainer.tsx\");\r\nvar TimerTask_1 = __webpack_require__(/*! ../TimerTask/TimerTask */ \"./src/shared/TimerTask/TimerTask.tsx\");\r\nvar Indent_1 = __webpack_require__(/*! ../Indent/Indent */ \"./src/shared/Indent/Indent.tsx\");\r\nvar react_redux_1 = __webpack_require__(/*! react-redux */ \"./node_modules/react-redux/es/index.js\");\r\nvar actions_1 = __webpack_require__(/*! ../../store/timer/actions */ \"./src/store/timer/actions.ts\");\r\nvar sound_1 = __webpack_require__(/*! ../audio/sound */ \"./src/shared/audio/sound.tsx\");\r\nvar react_2 = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\r\nvar actions_2 = __webpack_require__(/*! ../../store/tasks/actions */ \"./src/store/tasks/actions.ts\");\r\nvar TimerStatusBar_1 = __webpack_require__(/*! ../TimerStatusBar/TimerStatusBar */ \"./src/shared/TimerStatusBar/TimerStatusBar.tsx\");\r\nvar weekDefault_1 = __webpack_require__(/*! ../utils/js/timerFunction/weekDefault */ \"./src/shared/utils/js/timerFunction/weekDefault.ts\");\r\nvar TimerOptionToogleBtn_1 = __webpack_require__(/*! ../TimerOptions/TimerOptionToogleBtn */ \"./src/shared/TimerOptions/TimerOptionToogleBtn/index.ts\");\r\nvar TimerOptions_1 = __webpack_require__(/*! ../TimerOptions/TimerOptions */ \"./src/shared/TimerOptions/TimerOptions.tsx\");\r\nvar timerId;\r\nvar tasksIsNotRestCount = 0;\r\nvar nowDate = new Date().toJSON().slice(0, 10).replace(/-/g, '-');\r\nfunction Timer() {\r\n    var dispatch = (0, react_redux_1.useDispatch)();\r\n    var timerStorageData = typeof localStorage !== \"undefined\" ? localStorage.getItem('timerData') : null;\r\n    var timerStorageDataJSON = timerStorageData !== null ? JSON.parse(timerStorageData) : {};\r\n    var valueClock = (0, react_redux_1.useSelector)(function (state) { return state.timerClock; });\r\n    var timerOptions = (0, react_redux_1.useSelector)(function (state) { return state.options; });\r\n    var timerOptionsData = typeof localStorage !== \"undefined\" ? localStorage.getItem('timerOptions') : null;\r\n    var timerOptionsDataJSON = timerOptionsData !== null ? JSON.parse(timerOptionsData) : {};\r\n    var timerStateData = typeof localStorage !== \"undefined\" ? localStorage.getItem('timerState') : null;\r\n    var timerStateDataJSON = timerStateData !== null ? JSON.parse(timerStateData) : {};\r\n    var TaskArr = (0, react_redux_1.useSelector)(function (state) { return state.taskArr.arr; });\r\n    var time = valueClock.minutes * 60 + valueClock.seconds;\r\n    var _a = (0, react_1.useState)(time), tick = _a[0], setTick = _a[1];\r\n    var _b = (0, react_1.useState)((timerStateDataJSON === null || timerStateDataJSON === void 0 ? void 0 : timerStateDataJSON.numberOfTask) ? timerStateDataJSON.numberOfTask : 1), numberOfTasks = _b[0], setNumberOfTasks = _b[1];\r\n    var _c = (0, react_1.useState)(1), minutesWorks = _c[0], setMinutesWork = _c[1];\r\n    var _d = (0, react_1.useState)(false), optionsIsOpen = _d[0], setOptionsIsOpen = _d[1];\r\n    (0, react_2.useEffect)(function () {\r\n        var _a, _b;\r\n        if (timerStorageData !== null) {\r\n            var dateInArr = new Date(timerStorageDataJSON.nowWeek[timerStorageDataJSON.nowWeek.length - 1].dateDay);\r\n            if (dateInArr.getDate() < new Date().getDate()) {\r\n                timerStorageDataJSON.beforeLastWeek = [];\r\n                (_a = timerStorageDataJSON.beforeLastWeek).push.apply(_a, timerStorageDataJSON.lastWeek);\r\n                timerStorageDataJSON.lastWeek = [];\r\n                (_b = timerStorageDataJSON.lastWeek).push.apply(_b, timerStorageDataJSON.nowWeek);\r\n                timerStorageDataJSON.nowWeek = [];\r\n                timerStorageDataJSON.nowWeek = (0, weekDefault_1.weekDefault)('nowWeek');\r\n                localStorage.setItem('timerData', JSON.stringify(timerStorageDataJSON));\r\n            }\r\n        }\r\n        else {\r\n            localStorage.setItem('timerData', JSON.stringify({\r\n                'beforeLastWeek': (0, weekDefault_1.weekDefault)('beforeLastWeek'),\r\n                'lastWeek': (0, weekDefault_1.weekDefault)('lastWeek'),\r\n                'nowWeek': (0, weekDefault_1.weekDefault)('nowWeek')\r\n            }));\r\n        }\r\n    }, []);\r\n    (0, react_2.useEffect)(function () {\r\n        if (timerStateDataJSON.nowDay !== nowDate) {\r\n            setNumberOfTasks(1);\r\n            timerStateDataJSON.nowDay = nowDate;\r\n            localStorage.setItem('timerState', JSON.stringify(timerStateDataJSON));\r\n        }\r\n    }, []);\r\n    (0, react_2.useEffect)(function () {\r\n        console.log(timerStateData);\r\n        if (timerStateDataJSON.time === null || timerStateDataJSON.time === undefined) {\r\n            localStorage.setItem('timerState', JSON.stringify({\r\n                isLoad: true,\r\n                time: valueClock.minutes * 60 + valueClock.seconds,\r\n                isActive: null,\r\n                isRest: false\r\n            }));\r\n        }\r\n        else {\r\n            dispatch((0, actions_1.timerSetStateAction)(Math.floor(timerStateDataJSON.time / 60), timerStateDataJSON.time % 60, timerStateDataJSON.isRest, timerStateDataJSON.isActive, timerStateDataJSON.count));\r\n        }\r\n        if (timerOptionsData === null) {\r\n            localStorage.setItem('timerOptions', JSON.stringify({\r\n                timePomodor: 25,\r\n                timeShortRest: 5,\r\n                timeLongRest: 15,\r\n                frequencyLongRest: 4,\r\n                alertToggle: true\r\n            }));\r\n        }\r\n    }, []);\r\n    window === null || window === void 0 ? void 0 : window.addEventListener('beforeunload', function () {\r\n        timerStateDataJSON.time = tick;\r\n        timerStateDataJSON.isActive = valueClock.isActive;\r\n        timerStateDataJSON.isRest = valueClock.isRest;\r\n        timerStateDataJSON.count = valueClock.count;\r\n        timerStateDataJSON.numberOfTask = numberOfTasks;\r\n        localStorage.setItem('timerState', JSON.stringify(timerStateDataJSON));\r\n        timerOptionsDataJSON.alertToggle = timerOptions.alertToggle;\r\n        timerOptionsDataJSON.frequencyLongRest = timerOptions.frequencyLongRest;\r\n        timerOptionsDataJSON.timeLongRest = timerOptions.timeLongRest;\r\n        timerOptionsDataJSON.timeShortRest = timerOptions.timeShortRest;\r\n        timerOptionsDataJSON.timePomodor = timerOptions.timePomodor;\r\n        localStorage.setItem('timerOptions', JSON.stringify(timerOptionsDataJSON));\r\n    });\r\n    (0, react_2.useEffect)(function () {\r\n        function timerAllTime() {\r\n            dispatch((0, actions_1.allTimeTimerAction)(valueClock.minutesInTimer = valueClock.minutesInTimer + 1));\r\n            loadNewLocalStorageData('allTimeInTimer');\r\n        }\r\n        var timerId = setInterval(timerAllTime, 60000); //считает время проведенного в таймере\r\n        return function () { clearInterval(timerId); };\r\n    }, [valueClock.minutesInTimer]);\r\n    //Загружает увеличенные на единицу данные в localStorage\r\n    function loadNewLocalStorageData(option) {\r\n        timerStorageDataJSON.nowWeek.map(function (i) {\r\n            var sample = i[option];\r\n            if (i['dateDay'] === nowDate) {\r\n                sample = typeof sample === \"number\" ? sample + 1 : sample;\r\n                i[option] = sample;\r\n            }\r\n        });\r\n        localStorage.setItem('timerData', JSON.stringify(timerStorageDataJSON));\r\n    }\r\n    var timer = function () {\r\n        if (tick <= 1) {\r\n            resetTimer();\r\n        }\r\n        else {\r\n            setTick(tick - 1);\r\n        }\r\n    };\r\n    (0, react_2.useEffect)(function () {\r\n        setOptionsIsOpen(optionsIsOpen);\r\n    }, [optionsIsOpen]);\r\n    (0, react_2.useEffect)(function () {\r\n        setMinutesWork(minutesWorks);\r\n    }, [minutesWorks]);\r\n    (0, react_2.useEffect)(function () {\r\n        if (tasksIsNotRestCount >= 2) {\r\n            setNumberOfTasks(numberOfTasks + 1);\r\n            tasksIsNotRestCount = 1;\r\n        }\r\n        else\r\n            tasksIsNotRestCount = tasksIsNotRestCount + 1;\r\n        if (valueClock.count % 2 === 0) {\r\n            startTimerRest();\r\n        }\r\n    }, [valueClock.count]);\r\n    (0, react_2.useEffect)(function () {\r\n        if (valueClock.isActive) {\r\n            timerId = setInterval(timer, 1000);\r\n            //записывает минуты за работой в локальное хранилище \r\n            if (tick % 60 === 0 && tick !== time && !valueClock.isRest) {\r\n                loadNewLocalStorageData('totalWorkingMinutes');\r\n            }\r\n            else {\r\n                if (tick % 60 === 0 && tick !== time && valueClock.isRest) {\r\n                    loadNewLocalStorageData('minutesOnPause');\r\n                }\r\n            }\r\n        }\r\n        return function () { clearInterval(timerId); };\r\n    }, [tick, valueClock.isActive]);\r\n    function startTimerRest() {\r\n        if ((Math.floor(valueClock.count / 2)) % timerOptions.frequencyLongRest === 0) {\r\n            dispatch((0, actions_1.startTimerAction)(timerOptions.timeLongRest, 0, true));\r\n        }\r\n        else\r\n            dispatch((0, actions_1.startTimerAction)(timerOptions.timeShortRest, 0, true));\r\n        dispatch((0, actions_1.toggleTimerRestAction)(true));\r\n    }\r\n    function startTimer() {\r\n        dispatch((0, actions_1.startTimerAction)(valueClock.minutes, valueClock.seconds, true));\r\n    }\r\n    function pauseTimer() {\r\n        dispatch((0, actions_1.stopTimerAction)(Math.floor(tick / 60), tick % 60, false));\r\n    }\r\n    function addTimerMinutes() {\r\n        dispatch((0, actions_1.addTimeTimerAction)(Math.floor(tick / 60)));\r\n    }\r\n    (0, react_2.useEffect)(function () {\r\n        setTick(valueClock.minutes * 60 + valueClock.seconds);\r\n    }, [valueClock.minutes]);\r\n    //перезагружает и обнуляет таймер\r\n    function resetTimer() {\r\n        var _a;\r\n        dispatch((0, actions_1.resetTimerAction)(timerOptionsDataJSON.timePomodor)); // обнуляет таймер\r\n        setTick(valueClock.minutes * 60 + valueClock.seconds); // рендерит обнуленное значение\r\n        dispatch((0, actions_1.toggleTimerRestAction)(!valueClock.isRest));\r\n        dispatch((0, actions_1.numberOfTriggeredTimers)(valueClock.count));\r\n        if (((_a = TaskArr[0]) === null || _a === void 0 ? void 0 : _a.number) > 1 && !valueClock.isRest) { // уменьшает/удаляет элемент списка \r\n            dispatch((0, actions_2.RemoveTaskNumberAction)(TaskArr[0].id));\r\n            loadNewLocalStorageData('tomatoes');\r\n        }\r\n        else {\r\n            if (tasksIsNotRestCount >= 2 && TaskArr[0].number === 1) {\r\n                dispatch((0, actions_2.DeleteTasksItem)(TaskArr[0].id));\r\n                loadNewLocalStorageData('tomatoes');\r\n            }\r\n        }\r\n        clearInterval(timerId);\r\n        if (timerOptions.alertToggle) {\r\n            alert('Таймер остановлен');\r\n        }\r\n        (0, sound_1.sound)(); //звук окончания таймера\r\n    }\r\n    //перезагружает и обнуляет таймер\r\n    function stopTimer() {\r\n        dispatch((0, actions_1.resetTimerAction)(timerOptionsDataJSON.timePomodor)); // обнуляет таймер\r\n        setTick(valueClock.minutes * 60 + valueClock.seconds); // рендерит обнуленное значение\r\n        clearInterval(timerId);\r\n        loadNewLocalStorageData('stops');\r\n        if (timerOptions.alertToggle) {\r\n            alert('Таймер остановлен');\r\n        }\r\n        (0, sound_1.sound)(); //звук окончания таймера\r\n    }\r\n    return (react_1.default.createElement(\"div\", { className: timer_css_1.default.box },\r\n        react_1.default.createElement(TimerHeader_1.TimerHeader, { isRest: valueClock.isRest, taskName: TaskArr.length > 0 ? TaskArr[0].value : 'Добавьте задачу', isActive: valueClock.isActive }),\r\n        react_1.default.createElement(TimerOptionToogleBtn_1.TimerOptionToogleBtn, { onClick: function () { return setOptionsIsOpen(!optionsIsOpen); } }),\r\n        react_1.default.createElement(TimerOptions_1.TimerOptions, { onClose: function () { return setOptionsIsOpen(!optionsIsOpen); }, valueDefault: timerOptions, isOpen: optionsIsOpen }),\r\n        react_1.default.createElement(TimerStatusBar_1.TimerStatusBar, { timeStart: time, timeNow: tick }),\r\n        react_1.default.createElement(Indent_1.Indent, { indent: 'bottom', size: 70 }),\r\n        react_1.default.createElement(TimerClockContainer_1.TimerClockContainer, { isRest: valueClock.isRest, addClick: addTimerMinutes, isActive: valueClock.isActive, valueClock: {\r\n                minutes: Math.floor(tick / 60),\r\n                seconds: tick % 60\r\n            } }),\r\n        react_1.default.createElement(TimerTask_1.TimerTask, { taskNumber: numberOfTasks, taskName: TaskArr.length > 0 ? TaskArr[0].value : 'Добавьте задачу' }),\r\n        react_1.default.createElement(Indent_1.Indent, { indent: 'bottom', size: 32 }),\r\n        react_1.default.createElement(TimerButtonsContainer_1.TimerButtonsContainer, { isRest: valueClock.isRest, notTask: TaskArr.length > 0 ? false : true, pauseTimer: pauseTimer, resetTimer: resetTimer, isActive: valueClock.isActive, stopTimer: stopTimer, startTimer: startTimer }),\r\n        react_1.default.createElement(Indent_1.Indent, { indent: 'bottom', size: 107 })));\r\n}\r\nexports.Timer = Timer;\r\n\n\n//# sourceURL=webpack://reactjs/./src/shared/Timer/Timer.tsx?");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("15952bb9cade01f107ee")
/******/ })();
/******/ 
/******/ }
);